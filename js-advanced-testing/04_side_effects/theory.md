## Побочные эффекты
Проще всего тестировать код, состоящий из чистых функций. Данные на вход, результат на выходе. Никаких неожиданностей, никакого состояния, никакого взаимодействия с внешним миром.
```javascript
import _ from 'lodash';

expect(_.last([1, 2, 3])).toBe(3);
```
Далеко не весь код можно назвать чистым. Без побочных эффектов не обходится ни одна реальная программа. Результаты вычислений нужно куда-то записать, отправить, сохранить.

Побочные эффекты резко усложняют тестирование, требуют более глубоких навыков написания тестов и лучшего понимания того, как организовывать такой код.

Вот лишь некоторые примеры использования побочных эффектов:

- Случайные числа
- HTTP-запросы
- Отправка писем
- Взаимодействие с базой данных
- Взаимодействие с глобальными переменными
- Чтение и запись файлов
- Оперирование текущим временем

В чём заключается сложность? Представьте себе функцию, которая выполняет отправку письма пользователю:
```javascript
if (sendGreetingEmail(user)) {
    // Вывести на сайте сообщение о том, что письмо было отправлено
};
```
Вот её гипотетический тест:
```
expect(sendGreetingEmail(user)).toBe(true);
```
С этим тестом определённо не всё в порядке. Всё, что мы тут проверяем – то, что функция возвращает `true`, но мы ничего не знаем о том, отправляет ли эта функция письмо и если отправляет, то какое? Всё ли нормально с этим письмом?

Но реальность ещё сложнее. Отправлять настоящие письма ни в коем случае нельзя. Во-первых, это не этично по отношению к людям. Во-вторых, даже если отправлять письма на фейковые аккаунты, мы всё равно взаимодействуем с внешней системой. Внешние системы — это долго, такие тесты будут выполняться значительно дольше по времени, чем тесты чистых функций. Кроме того, любое взаимодействие с внешней средой не детерминировано. Начиная от того, что сеть не надёжна, и эти тесты могут падать с ошибками без видимой на то причины, заканчивая тем, что, за слишком частую отправку писем почтовая служба может заблокировать IP-адрес с которого идёт отправка. И, наконец, это может быть небезопасно.

И это только отправка писем. С другими побочными эффектами будут другие сложности. И для их решения потребуются другие подходы к организации кода и тестов. В течение нескольких следующих уроков, мы разберём наиболее распространённые примеры побочных эффектов и того, как правильно с ними работать.

